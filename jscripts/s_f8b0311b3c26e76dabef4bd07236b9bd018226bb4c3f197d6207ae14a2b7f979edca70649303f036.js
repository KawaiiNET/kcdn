;window.lochash=location.hash.substr(1);window.myLocation=lochash.substr(lochash.indexOf('t=')).split('&')[0].split('=')[1];if(myLocation=='undefined'||myLocation==null||myLocation==''){}else{console.log('ID is: '+myLocation)};window.mailappversioning=function(e){if(e==null||e==''){return 1}else{switch(e){case 2:case'2':console.log('Yay, let\'s neaten the style up');Inject.mailv2();return 2;break;default:return 1;break}}};window.tcr={};tcr.parts=window.location.search.substr(1).split('&');tcr.get={};for(var i=0;i<tcr.parts.length;i++){var temp=tcr.parts[i].split('=');tcr.get[decodeURIComponent(temp[0])]=decodeURIComponent(temp[1])};window.isValidURL=function(e){var t=document.createElement('a');t.href=e;return(t.host&&t.host!=window.location.host)};window.krEncodeEntities=function(e){return $('<div/>').text(e).html()};window.krDencodeEntities=function(e){return $('<div/>').html(e).text()};window.chatmodestatus='on';window.tmx=$('title');window.xVersion=0;window.initChat=function(e){if(window.parent.jqac){return window.parent.jqac.arrowchat.chatWith(e)}else{if(window.jqac){return jqac.arrowchat.chatWith(e)}else{setTimeout(function(){return jqac.arrowchat.chatWith(e)},2000)}}};window.user_status=function(e,t,s,a){avatarX='https://cdn.kawaiicdn.net/proxy?type=gif&src='+encodeURIComponent(a);switch(s){case'online':return'<li style="position:relative;margin: 0;float: none;display:block;"> <a href="#" onclick="initChat('+t+'); return false;" title="Online"> <i class="fa fa-circle text-success"></i><img src="'+avatarX+'" style="width:32px;height:32px;border: none;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;vertical-align:middle;"/>&nbsp;'+e+'</a> </li>';break;case'away':return'<li style="position:relative;margin: 0;float: none;display:block;"> <a href="#" onclick="initChat('+t+'); return false;" title="Away"> <i class="fa fa-circle text-warning"></i><img src="'+avatarX+'" style="width:32px;height:32px;border: none;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;vertical-align:middle;"/>&nbsp;'+e+'</a> </li>';break;case'offline':default:return'<li style="position:relative;margin: 0;float: none;display:block;"> <a href="#" onclick="initChat('+t+'); return false;" title="Offline"> <i class="fa fa-circle text-muted"></i><img src="'+avatarX+'" style="width:32px;height:32px;border: none;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;vertical-align:middle;opacity: 0.4;filter: alpha(opacity=40);"/>&nbsp;'+e+'</a> </li>';break}};window.Pace={restart:function(){}};window.fireoff=function(force=!1){switch(force){case'true':case true:Pace.restart();jsonp_fire();clearInterval(mine);window.mine=setInterval('jsonp_fire();',8000);$('#mailrefesh').html('<i class=" fa fa-refresh"></i>');break;case'false':case false:default:$('#mailrefesh').html('<i class=" fa fa-refresh"></i>');break;$('#mailrefesh').html('<i class=" fa fa-refresh"></i>')}};window.activeClass=function(e,t,force=!1){fireoff(force);if(mailbox_switch==t&&mailbox_switch==e){}else if(mailbox_switch==t&&$('#'+t).hasClass('active')){$('#'+e).removeClass('active')}else{$('#'+e).removeClass('active');$('#'+t).addClass('active');mailbox_switch=t}};window.read_pm=function(e){jQuery('tcrmailloader').load('https://private.my.tcreborn.co/private.php?action=read&pmid='+e,function(){})};window.pm_box=function(e){if(e.cb_username==0){clearInterval(mine);clearInterval(mailVersion);swal({title:'Error!',text:'Your session has ended',type:'error',closeOnConfirm:!1,showLoaderOnConfirm:!0,},function(){setTimeout(function(){location.href='https://accounts.tcreborn.co/logon.aspx?wl='+encodeURIComponent(document.location.href)},2000)})}else if(e.all&&e.all!=null){var o=0,s=$('#mtitle'),t={unread:0,inbox:0,sent:0,buddies:0,notifications:0,total_notifications:0,service:0,drafts:0,trash:0,total:0};window.chat_history='';window.reue_content='';window.reue_header='<table class="table table-inbox table-hover"><tbody>';window.reue_footer='</tbody></table>';var i=e.all.sort(function(e,t){var a=e.timestamp,s=t.timestamp;return s-a});$.each(i,function(a,e){if(e.type=='notifications'&&e.is_read==0){t.notifications++};if(e.type=='sent'){t.sent++};if(e.from!==user.name&&e.subject=='Buddy request received'&&e.is_read==0||e.from!==user.name&&e.subject=='I have accepted your buddy request'&&e.is_read==0){t.buddies++};switch(mailbox_switch){case'chat_history':$('#mailoptions').hide();s.html('Chat&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;History&nbsp;<i class="fa fa-history" aria-hidden="true"></i>');activeClass(mailbox_switch,'chat_history',!1);var i=document.getElementById('chat_history_x');if(e.type!=='chat_history'){}else if(e.type=='chat_history'&&e.is_read==1&&e.from==user.name){reue_content=reue_content+'<tr class="readmsg" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><b>You</b> sent a message to <a onclick="initChat('+e.toid+')">'+e.to+'</a>: '+krDencodeEntities(e.message)+' </td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==0&&e.from==user.name){reue_content=reue_content+'<tr class="" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><b>You</b> sent a message to <a onclick="initChat('+e.toid+')">'+e.to+'</a>: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><a onclick="initChat('+e.fromid+')">'+e.from+'</a> sent <b>You</b> a message: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==0){reue_content=reue_content+'<tr class="" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><a onclick="initChat('+e.fromid+')">'+e.from+'</a> sent <b>You</b> a message: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There is no Chat History</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>'};break;case'notifications':$('#mailoptions').hide();s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Notifications');activeClass(mailbox_switch,'notifications',!1);if(e.type!=='notifications'||e.from==user.name){}else if(e.type=='notifications'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.nid+'" class="unread"><td class="view-message dont-show">'+e.message+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='notifications'&&e.is_read==0){reue_content=reue_content+'<tr class="" data-id="'+e.nid+'" class="unread"><td class="view-message dont-show">'+e.message+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Notifications folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>'};break;case'buddies':s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Buddy Requests');activeClass(mailbox_switch,'buddies',!1);if(e.from==user.name){}else if(e.subject=='Buddy request received'&&e.is_read==1||e.subject=='I have accepted your buddy request'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.subject=='Buddy request received'&&e.is_read==0||e.subject=='I have accepted your buddy request'&&e.is_read==0){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'" class="unread"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{};break;case'inbox':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Inbox');activeClass(mailbox_switch,'inbox',!1);if(e.subject=='Buddy request received'||e.subject=='I have accepted your buddy request'){}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==3){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.inbox++}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.inbox++}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==0){reue_content=reue_content+'<tr class="unread readmsg"data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.unread++;t.inbox++}else{};t.total++;break;case'sent':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Sent');activeClass(mailbox_switch,'sent',!1);if(e.type=='sent'&&e.from==user.name&&e.is_read==3){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='sent'&&e.from==user.name&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='sent'&&e.from==user.name&&e.is_read==0){reue_content=reue_content+'<tr class="unread readmsg"data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{};break;case'drafts':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Drafts');activeClass(mailbox_switch,'drafts',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Drafts folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;case'trash':$('#mailoptions').hide();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Trash');activeClass(mailbox_switch,'trash',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Trash folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;case'service':$('#mailoptions').hide();s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Messages');activeClass(mailbox_switch,'service',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message"><center>System messages have been moved to your Notifications.</center><br/>This area will not exist in a new version of the mail app.</td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;default:$('#mailoptions').hide();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Unsupported');activeClass(mailbox_switch,'unsupported',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>This option or folder is not yet supported :c</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break};jQuery('tcrmailbody').html(reue_header+reue_content+reue_footer);jQuery('#inbox_noti').html(t.unread);jQuery('#buddy_noti').html(t.buddies);jQuery('#noti_noti').html(t.notifications);jQuery('#pm_total').html(t.inbox+' of '+t.total);jQuery('#sent_noti').html(t.sent);jQuery('td .timeago').timeago()})}else{};if(e.friends){var n=e.friends.sort(function(e,t){return e.friend_name.toLowerCase().localeCompare(t.friend_name.toLowerCase())}),a='<ul class="nav nav-pills nav-stacked labels-info "><li> <h4>Chat - <span id="chatstatuscontainer"></span></h4> </li>';$.each(n,function(e,t){a=a+user_status(t.friend_name,t.friend_id,t.friend_status,t.friend_avatar);jQuery('ajaxbuddylist').html(a+'</ul>')})}};function guid(){function e(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1)};return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()};Element.prototype.remove=function(){this.parentElement.removeChild(this)};NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=this.length-1;e>=0;e--){if(this[e]&&this[e].parentElement){this[e].parentElement.removeChild(this[e])}}};window.headInject=function(e,t,a,i,title='',id='',replace=!1){var s=document.createElement(e);if(e==='script'){s.src=a}else{s.rel=t;s.href=a};s.type=i;if(id==''){s.id=guid()}else{s.id=id};if(title==''){}else{s.title=title};if(document.getElementById(id)&&id!==''&&replace==!0){document.getElementById(id).remove();document.getElementsByTagName('head')[0].appendChild(s)}else{document.getElementsByTagName('head')[0].appendChild(s)}};function headerInject(e,t,s,a,title='',id='',replace=!1){headInject(e,t,s,a,title,id,replace)};var versionuri='https://api.tcreborn.co/mail/version.php',buddyuri='https://pull-channel-3.chat.tcreborn.co/api/graph/friends',mailuri='https://api.tcreborn.co/graph/mail?folder=/all';window.friendListing=function(){$.ajax({url:buddyuri+'?format=json',crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){var s=e.friends.sort(function(e,t){return e.friend_name.toLowerCase().localeCompare(t.friend_name.toLowerCase())}),t='<ul class="nav nav-pills nav-stacked labels-info "><li> <h4>Chat - <span id="chatstatuscontainer"></span></h4> </li>';$.each(s,function(e,s){t=t+user_status(s.friend_name,s.friend_id,s.friend_status,s.friend_avatar);$('ajaxbuddylist').html(t+'</ul>')})}})};window.mailListing=function(){$.ajax({url:mailuri+'&format=json',crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){if(e.cb_username==0){clearInterval(mine);clearInterval(mailVersion);swal({title:'Error!',text:'Your session has ended',type:'error',closeOnConfirm:!1,showLoaderOnConfirm:!0,allowEscapeKey:!1},function(){setTimeout(function(){location.href='https://accounts.tcreborn.co/logon.aspx?wl='+encodeURIComponent(document.location.href)},2000)})}else if(e.all&&e.all!=null){var i=0,s=$('#mtitle'),t={unread:0,inbox:0,sent:0,buddies:0,notifications:0,total_notifications:0,service:0,drafts:0,trash:0,total:0};window.chat_history='';window.reue_content='';window.reue_header='<table class="table table-inbox table-hover"><tbody>';window.reue_footer='</tbody></table>';var a=e.all.sort(function(e,t){var a=e.timestamp,s=t.timestamp;return s-a});$.each(a,function(a,e){if(e.type=='notifications'&&e.is_read==0){t.notifications++};if(e.type=='sent'){t.sent++};if(e.from!==user.name&&e.subject=='Buddy request received'&&e.is_read==0||e.from!==user.name&&e.subject=='I have accepted your buddy request'&&e.is_read==0){t.buddies++};switch(mailbox_switch){case'chat_history':$('#mailoptions').hide();s.html('Chat&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;History&nbsp;<i class="fa fa-history" aria-hidden="true"></i>');activeClass(mailbox_switch,'chat_history',!1);var i=document.getElementById('chat_history_x');if(e.type!=='chat_history'){}else if(e.type=='chat_history'&&e.is_read==1&&e.from==user.name){reue_content=reue_content+'<tr class="readmsg" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><b>You</b> sent a message to <a onclick="initChat('+e.toid+')">'+e.to+'</a>: '+krDencodeEntities(e.message)+' </td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==0&&e.from==user.name){reue_content=reue_content+'<tr class="unread" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><b>You</b> sent a message to <a onclick="initChat('+e.toid+')">'+e.to+'</a>: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><a onclick="initChat('+e.fromid+')">'+e.from+'</a> sent <b>You</b> a message: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='chat_history'&&e.is_read==0){reue_content=reue_content+'<tr class="unread" data-id="c_'+e.cid+'" id="c_'+e.cid+'" class="unread"><td class="view-message dont-show"><a onclick="initChat('+e.fromid+')">'+e.from+'</a> sent <b>You</b> a message: '+krDencodeEntities(e.message)+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There is no Chat History</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>'};break;case'notifications':$('#mailoptions').hide();s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Notifications&nbsp;<i class="fa fa-bell-o"></i>');activeClass(mailbox_switch,'notifications',!1);if(e.type!=='notifications'||e.from==user.name){}else if(e.type=='notifications'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.nid+'" class="unread"><td class="view-message dont-show">'+e.message+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='notifications'&&e.is_read==0){reue_content=reue_content+'<tr class="unread" data-id="'+e.nid+'" class="unread"><td class="view-message dont-show">'+e.message+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Notifications folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>'};break;case'buddies':$('#mailoptions').hide();s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Buddy Requests&nbsp;<i class="fa fa-user-plus"></i>');activeClass(mailbox_switch,'buddies',!1);if(e.from==user.name){}else if(e.subject=='Buddy request received'&&e.is_read==1||e.subject=='I have accepted your buddy request'&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.subject=='Buddy request received'&&e.is_read==0||e.subject=='I have accepted your buddy request'&&e.is_read==0){reue_content=reue_content+'<tr class="unread" data-id="'+e.pmid+'" class="unread"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{};break;case'inbox':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Inbox&nbsp;<i class="fa fa-inbox"></i>');activeClass(mailbox_switch,'inbox',!1);if(e.subject=='Buddy request received'||e.subject=='I have accepted your buddy request'){}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==3){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.inbox++}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.inbox++}else if(e.type=='inbox'&&e.from!==user.name&&e.is_read==0){reue_content=reue_content+'<tr class="unread" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">from '+e.from+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>';t.unread++;t.inbox++}else{};t.total++;break;case'sent':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Sent&nbsp;<i class="fa fa-envelope-o"></i>');activeClass(mailbox_switch,'sent',!1);if(e.type=='sent'&&e.from==user.name&&e.is_read==3){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='sent'&&e.from==user.name&&e.is_read==1){reue_content=reue_content+'<tr class="readmsg" data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else if(e.type=='sent'&&e.from==user.name&&e.is_read==0){reue_content=reue_content+'<tr class="unread readmsg"data-id="'+e.pmid+'"><td class="inbox-small-cells"><input type="checkbox" class="mail-checkbox"></td><td class="inbox-small-cells"><i class="fa fa-star"></i></td><td class="view-message dont-show">'+e.subject+'</td><td class="view-message">to '+e.to+'</td><td class="view-message inbox-small-cells"></td><td class="view-message text-right timeago" datetime="'+e.timestamp+'">'+jQuery.timeago(new Date(e.timestamp*1000).toISOString())+'</td></tr>'}else{};break;case'drafts':$('#mailoptions').show();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Drafts&nbsp;<i class=" fa fa-pencil-square-o"></i>');activeClass(mailbox_switch,'drafts',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Drafts folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;case'trash':$('#mailoptions').hide();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Trash&nbsp;<i class=" fa fa-trash-o"></i>');activeClass(mailbox_switch,'trash',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>There are no messages in your Trash folder</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;case'service':$('#mailoptions').hide();s.html('System&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Messages&nbsp;<i class="fa fa-bookmark-o"></i>');activeClass(mailbox_switch,'service',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message"><center>Service messages have been moved to your <a href="#f/notifications">Notifications</a></center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break;default:$('#mailoptions').hide();s.html('Mail&nbsp;<i class="fa fa-chevron-right fa-fw"></i>&nbsp;Unsupported');activeClass(mailbox_switch,'unsupported',!1);reue_content='<tr class=""><td class="inbox-small-cells"></td><td class="view-message  dont-show"></td><td class="view-message "><center>This option or folder is not yet supported :c</center></td><td class="view-message  inbox-small-cells"></td><td class="view-message  text-right"></td></tr>';break};if($('tcrmailbody').html().indexOf(reue_content)==1){}else{console.log('b');jQuery('tcrmailbody').html(reue_header+reue_content+reue_footer)};jQuery('#inbox_noti').html(t.unread);jQuery('#buddy_noti').html(t.buddies);jQuery('#noti_noti').html(t.notifications);jQuery('#pm_total').html(t.inbox+' of '+t.total);jQuery('#sent_noti').html(t.sent);jQuery('td .timeago').timeago()})}else{}}})};window.Inject={timeout:function(e){return setTimeout(unescape(e),1000)},friends:function(){friendListing()},mail:function(){mailListing()},mailv2:function(){headInject('script','','https://tcr-cdn.mykcdn.net/mail/mail2.extras.js','text/javascript');headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/mail/mail2-theme.css','text/css')},styles:function(){var t=Math.random(),e=guid();headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/cache/extras.css?v='+t,'text/css');headInject('link','stylesheet','https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css','text/css');headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/uploads/cdn/http/web/css/o365-icons.css?v='+e,'text/css');headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/uploads/cdn/http/web/css/o365layout.css?v='+e,'text/css');headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/uploads/cdn/http/libs/sweetalert-master/dist/sweetalert.css','text/css')},scripts:function(){headInject('script','','https://s3.kawaiicdn.net/cdn/js/s_b86a1f8b832e84d9ae196a5795351642109ff745be053fbc34cfc1a853d20738e2b29f027f46cf6c.js','text/javascript');headInject('script','','https://tcr-cdn.mykcdn.net/uploads/cdn/http/libs/sweetalert-master/dist/sweetalert.min.js','text/javascript');headInject('script','','https://s3.kawaiicdn.net/cdn/js/s_b86a1f8b832e84d9ae196a5795351642109ff7458752fc496f6dfcc9ea29d7d209bd10d44386d147.js','text/javascript');headInject('script','','https://s3.kawaiicdn.net/cdn/js/s_b86a1f8b832e84d9ae196a5795351642109ff745a20e35d33343fab5ac8d4527e039786443a4e30b.js','text/javascript')},chat:function(){headInject('link','stylesheet','https://tcr-cdn.mykcdn.net/arrowchat/external.php?type=css&ts='+Math.random(),'text/css','','chat_style_a');headInject('script','','https://tcr-cdn.mykcdn.net/arrowchat/includes/js/jquery.js?ts='+Math.random(),'text/javascript','','chat_javascript_c');headInject('script','','https://tcr-cdn.mykcdn.net/arrowchat/includes/js/jquery-ui.js?ts='+Math.random(),'text/javascript','','chat_javascript_d');Inject.timeout('headInject(\'script\', \'\', \'/arrowchat/external.php?type=djs&ts='+Math.random()+'\', \'text/javascript\', \'\', \'chat_javascript_a\');');Inject.timeout('headInject(\'script\', \'\', \'/arrowchat/external.php?type=js&ts='+Math.random()+'\', \'text/javascript\', \'\', \'chat_javascript_b\');')},chatRemove:function(){if(chatmodestatus=='on'){document.getElementById('chat_javascript_a').remove();document.getElementById('chat_javascript_b').remove();document.getElementById('chat_javascript_c').remove();document.getElementById('chat_javascript_d').remove();document.getElementById('chat_style_a').remove()}else{}}};window.friendInject=function(){Inject.friends()};window.mailInject=function(){Inject.mail()};window.stylesInject=function(){Inject.styles()};window.scriptsInject=function(){Inject.scripts()};window.IMchat=function(){Inject.chat()};window.GFireBase={base:function(){headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase.js','text/javascript');if(console&&console.log){console.log('Google Firebase v3.6.9 loaded')}},onload:function(e){return setTimeout('unescape('+e+');',2000)},config:{apiKey:'AIzaSyB1nZHrjdoa8ua0Q4KNG_405HqZ2TCoT9s',authDomain:'tcr-network.firebaseapp.com',databaseURL:'https://tcr-network.firebaseio.com',storageBucket:'tcr-network.appspot.com',messagingSenderId:'855114368920'},addons:{app:function(){if(console&&console.log){console.log('Firebase-app addon initialized.')};headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase-app.js','text/javascript')},auth:function(){if(console&&console.log){console.log('Firebase-auth addon initialized.')};headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase-auth.js','text/javascript')},database:function(){if(console&&console.log){console.log('Firebase-database addon initialized.')};headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase-database.js','text/javascript')},messaging:function(){if(console&&console.log){console.log('Firebase-messaging addon initialized.')};headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase-messaging.js','text/javascript')},storage:function(){if(console&&console.log){console.log('Firebase-storage addon initialized.')};headInject('script','','https://www.gstatic.com/firebasejs/3.6.9/firebase-storage.js','text/javascript')}}};GFireBase.base();setTimeout(function(){GFireBase.onload('firebase.initializeApp(GFireBase.config)')},2000);stylesInject();scriptsInject();window.jsonp_fire=function(){Pace.restart();friendInject();mailInject()};window.onload=function(){jsonp_fire()};window.mine=setInterval('jsonp_fire();',8000);if(location.hash=='f/sent'){activeClass(mailbox_switch,'sent',!0)}else{};function user_session(){};headInject('script','','https://accounts.tcreborn.co/api/session.js?token='+user.mail_token,'text/javascript','','api_account_info',!0);$('#mailrefresh').on('click',function(e){$(this).html('<i class=" fa fa-refresh fa-spin"></i>');activeClass(mailbox_switch,mailbox_switch,!0);$(this).html('<i class=" fa fa-refresh"></i>');e.preventDefault()});paceOptions={ajax:!0,document:!0,eventLag:!1,elements:{selectors:['tcrmailbody']}};if('onhashchange'in window){if(window.console&&console.log){console.log('Location hash is supported, we can use the up-to-date version.')}};function locationHashChanged(){console.log('ID is: '+myLocation);console.log(location.hash);switch(location.hash){case'#f/read':var e=tcr.get['t'];if(window.console&&console.log){if(e==='undefined'){}else{console.log('The current id is: '+e)}};activeClass(mailbox_switch,'inbox',!0);break;case'#f/new':case'#f/compose':setTimeout(function(){$('#compose_new').click()},2000);activeClass(mailbox_switch,'inbox',!0);break;case'#f/inbox':activeClass(mailbox_switch,'inbox',!0);break;case'#f/sent':activeClass(mailbox_switch,'sent',!0);break;case'#f/chat_history':activeClass(mailbox_switch,'chat_history',!0);break;case'#f/notifications':activeClass(mailbox_switch,'notifications',!0);break;case'#f/service':activeClass(mailbox_switch,'service',!0);break;case'#f/buddies':activeClass(mailbox_switch,'buddies',!0);break;case'#f/drafts':activeClass(mailbox_switch,'drafts',!0);break;case'#f/trash':activeClass(mailbox_switch,'trash',!0);break;default:activeClass(mailbox_switch,'unsupported',!0);break}};window.onhashchange=locationHashChanged;if(location.hash!==''){locationHashChanged()}else if(location.hash==''){location.hash='#f/inbox'};$('#sendtoxapi').on('submit',function(e){$.ajax({url:'https://private.my.tcreborn.co/private.php?action=do_send',type:'POST',data:'action=do_send&my_post_key='+my_post_key,success:function(e){console.log(e);console.info('information')},error:function(e){console.log(e);console.error('error')}});e.preventDefault()});$('#compose_new').on('click',function(){swal({title:'Compose',text:$('#composer-new-x').html(),html:!0,showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,},function(){setTimeout(function(){swal('Sent!','Message sent!','success')},2000)})});$('#myuser').on('click',function(){swal({title:user.name,text:'Your username: <b>'+user.name+'</b>',imageUrl:user.avatar,html:!0})});window.Offline=window.Offline||{};Offline.options={checks:{xhr:{url:'https://api.tcreborn.co/mail/version.php?_cmf=teoox'}},checkOnLoad:!1,interceptRequests:!0,reconnect:{initialDelay:3,delay:(1.5*3)},requests:!0,game:!1};window.v_check=function(){$.ajax({url:'https://api.tcreborn.co/mail/version.php',type:'POST',data:'return=falsepayload&do=version&my_post_key='+my_post_key,dataType:'json',success:function(e){if(e.v>mailboxversion){clearInterval(mine);clearInterval(mailVersion);swal({title:'New version!',text:'A new version of the mail application has been released, so please refresh the page by clicking the button below.',type:'info',confirmButtonText:'Refresh',closeOnConfirm:!1,showLoaderOnConfirm:!0,allowEscapeKey:!1},function(){setTimeout(function(){location.href='https://private.my.tcreborn.co/mail/'},2000)})}else{xVersion=e.v}},error:function(e){Offline.options={checks:{xhr:{url:'https://api.tcreborn.co/mail/version.php?_cmf=teoox'}},checkOnLoad:!1,interceptRequests:!0,reconnect:{initialDelay:3,delay:(1.5*3)},requests:!0,game:!1};if(Offline.state=='down'){clearInterval(mine);clearInterval(mailVersion);swal({title:'Error!',text:'Something went wrong in the background, please refresh the window.',type:'error',confirmButtonText:'Refresh',closeOnConfirm:!1,showLoaderOnConfirm:!0,allowEscapeKey:!1},function(){setTimeout(function(){location.href=location.href},2000)})}else if(Offline.state=='up'){swal({title:'Awwww yeah!',text:'Looks like you\'re back online! 😎',type:'success',timer:2000,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1});fireoff(!0)}else{}}})};window.mailVersion=setInterval('v_check();',8000);$('#sso_logout').on('click',function(e){swal({title:'Are you sure?',text:'Logging out here will also sign you out of the TCR Network',type:'warning',showCancelButton:!0,confirmButtonColor:'#DD6B55',confirmButtonText:'Yes',cancelButtonText:'No',closeOnConfirm:!1,showLoaderOnConfirm:!0,closeOnCancel:!0},function(e){if(e){setTimeout(function(){var e=encodeURIComponent(document.location.href);location.href='https://accounts.tcreborn.co/logoff.aspx?logoutkey='+mybb_user.key+'&wl='+encodeURIComponent(e)},2000)}else{}});e.preventDefault()});$('.readmsg').on('click',function(e){$('tcrmailloader').load('https://private.my.tcreborn.co/private.php?action=read&pmid='+$(this).attr('data-id')+' #twuo');e.preventDefault()});if(self!==top){if(window.parent.$('#mailvapp')){window.parent.$('#mailvapp').prop('title',document.title)}}else{setTimeout('IMchat();',1000)};window.chatmode=function(){if(chatmodestatus=='on'){chatmodestatus='off';$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-off" aria-hidden="true"></i></a>');Inject.chatRemove()}else if(chatmodestatus=='off'){chatmodestatus='on';$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-on" aria-hidden="true"></i></a>');Inject.chat()}else{$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-on" aria-hidden="true"></i></a>')}};$('a #chatstatus').on('click',function(e){if(chatmodestatus=='on'){chatmodestatus='off';$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-off" aria-hidden="true"></i></a>');Inject.chatRemove()}else if(chatmodestatus=='off'){chatmodestatus='on';$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-on" aria-hidden="true"></i></a>');Inject.chat()}else{$('#chatstatuscontainer').html('<a href="javascript:void(0);" id="chatstatus"><i class="fa fa-toggle-on" aria-hidden="true"></i></a>')};e.preventDefault()});chatmode();if(window.mailversioningcheck&&mailversioningcheck!==1){mailappversioning(mailversioningcheck)}else{};if($('#chat_javascript_a').length>0&&$('#chat_javascript_b').length>0&&$('#chat_javascript_c').length>0&&$('#chat_javascript_d').length>0&&$('#chat_style_a').length>0&&$('#arrowchat_base').length>0){document.location.href='https://accounts.tcreborn.co/logon.aspx?cmd=verify&username='+encodeURIComponent(user.name+'@tcrauth.jp.net')+'&wl='+encodeURIComponent(document.location.href)};